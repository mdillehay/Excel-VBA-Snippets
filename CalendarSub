Global startMonth As Integer
Global numYears As Integer
Global monthList As New Collection



Sub Button1_Click()

    Test

Application.ScreenUpdating = False

Dim count As Integer, sDay As Integer

sDay = Range("A1:DP1").count





Dim Months(0 To 11) As String

Dim Sheet4 As Worksheet
Set Sheet4 = Sheets("Sheet4")

For i = 0 To 11

    Months(i) = Sheet4.Cells(1, (i + 2)).Value
Next i

Dim MonthRange(1 To 12) As Integer

Dim Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec As Range

Set Jan = Sheet1.Range("B2:B32")
Set Feb = Sheet1.Range("C2:C29")
Set Mar = Sheet1.Range("D2:D32")
Set Apr = Sheet1.Range("E2:E31")
Set May = Sheet1.Range("F2:F32")
Set Jun = Sheet1.Range("G2:G31")
Set Jul = Sheet1.Range("H2:H32")
Set Aug = Sheet1.Range("I2:I32")
Set Sep = Sheet1.Range("J2:J31")
Set Oct = Sheet1.Range("K2:K32")
Set Nov = Sheet1.Range("L2:L31")
Set Dec = Sheet1.Range("L2:L32")

MonthCount = Array(Oct.count, Nov.count, Dec.count, Jan.count, Feb.count, Mar.count, Apr.count, May.count, Jun.count, Jul.count, Aug.count, Sep.count)

Dim x As Integer, y As Integer, yy As Integer

Dim Z As Range, dayCounter As Integer, ddCounter As Integer, twCounter As Integer, shortDayCounter As Integer

ddDay = Array("S", "M", "T", "W", "T", "F", "S")

x = 1
y = 1
count = 0
dayCounter = 1
ddCounter = 6
twCounter = 1
shortDayCounter = 0

For i = 0 To 11
    
    yy = count + MonthCount(i)
    
    Set Z = Sheets("Sheet1").Range(Cells(x, y), Cells(x, yy))
    
    With Z
        .Merge
        .Value = Months(i)
        .HorizontalAlignment = xlCenter
        .Borders.LineStyle = xlGray75
    End With
    
    For g = y To yy
        Cells((x + 3), g).Value = dayCounter
        With Cells((x + 3), g)
            .ColumnWidth = 3
            .HorizontalAlignment = xlCenter
            .Borders.LineStyle = xlGray75
        End With
        
        If ddCounter = 7 Then
            
            If g < 7 Then
                With Range(Cells((x + 1), (g - shortDayCounter)), Cells((x + 1), (g)))
                    .Merge
                    .HorizontalAlignment = xlCenter
                    .Borders.LineStyle = xlGray75
                End With
                If twCounter = 53 Then
                    twCounter = 1
                End If
                Range(Cells((x + 1), (g - shortDayCounter)), Cells((x + 1), (g))).Value = ("TW " + Str(twCounter))
                twCounter = twCounter + 1
            Else
                With Range(Cells((x + 1), (g - 6)), Cells((x + 1), (g)))
                    .Merge
                    .HorizontalAlignment = xlCenter
                    .Borders.LineStyle = xlGray75
                End With
            
                If twCounter = 53 Then
                    twCounter = 1
                End If
                Range(Cells((x + 1), (g - 6)), Cells((x + 1), (g))).Value = ("TW " + Str(twCounter))
                twCounter = twCounter + 1
            End If
        End If
        
        If ddCounter <= 6 Then
            Cells((x + 2), g).Value = ddDay(ddCounter)
        Else
            ddCounter = 0
            Cells((x + 2), g).Value = ddDay(ddCounter)
        End If
        
        With Cells((x + 2), g)
            .HorizontalAlignment = xlCenter
            .Borders.LineStyle = xlGray75
        End With
        
        
        
        
        ddCounter = ddCounter + 1
        dayCounter = dayCounter + 1
        shortDayCounter = shortDayCounter + 1
        
    Next g
    
    count = count + MonthCount(i)
    y = (1 + yy)
    dayCounter = 1
    
        
Next i


Application.ScreenUpdating = True




End Sub


Sub Test()

Application.ScreenUpdating = False

Dim locStartMonth As Integer, locNumYear As Integer, counter As Integer
Dim loc_i As Integer, iterMon As Integer

Form1.Show


locNumYear = numYears

iterMonArr = Array("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
counter = (locNumYear * 12)
loc_i = 1
iterMon = startMonth



While loc_i <= counter
    If iterMon > 12 Then
        iterMon = 1
    End If
    monthList.Add (iterMonArr(iterMon - 1))
    iterMon = iterMon + 1
    loc_i = loc_i + 1
Wend
    
'MsgBox (monthList(1))

Application.ScreenUpdating = True
End Sub
